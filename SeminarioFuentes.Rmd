---
title:    |
  |Seminario Fuentes: 
  Suicidios dependientes de salud mental frente a desigualdades económicas
  
author:   |
  **Malena Pérez Sevilla, Fátima Ezzahra Makroudi Ouennas**
  
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
  html_document:
    csl: apa.csl
    df_print: paged
    toc: yes
    toc_float: yes
  pdf_document: 
    toc: yes
always_allow_html: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE) 
```
# Resumen

# Introducción

El suicidio es un problema de salud pública muy complejo en el que pueden intervenir diversos factores, en este caso nos centraremos en estudiar la relación entre la salud mental y la posibilidad de acceso a los servicios sanitarios de ese ámbito junto con la desigualdad económica entre la población española por comunidades. 
Para medir la desigualdad se pueden utilizar distintos indicadores, entre ellos encontramos el cociente S80/S20. Éste mide, según la INE (Instituto Nacional de Estadística),la desigualdad a través de ratios entre percentiles. Se interpreta como la relación entre la renta media obtenida por el 20% de la población con la renta más alta (quintil más alto), en relación a la renta media obtenida por el 20% de la población con la renta más baja (quintil más bajo).

En primer lugar, vamos a definir los siguientes conceptos claves:

* **Salud mental:**
*«Estado de bienestar en el cual cada individuo desarrolla su potencial, puede afrontar las tensiones de la vida, puede trabajar de forma productiva y fructífera, y puede aportar algo a su comunidad».[@OMS]*
Este estado de bienestar mental muchas veces es alterado por perturvaciones, por lo que puede derivar a trastornos mentales, esto causa angustia y/o altera las capacidades funcionales de la persona.

* **Suicidio:**
*«Todo acto por el que un individuo se causa a sí mismo una lesión, o un daño, con un grado variable en la intención de morir, cualquiera sea el grado de intención letal o de conocimiento del verdadero móvil».[@OMS]*
Este acto es previamente meditado y realizado por una persona, que es totalemnte consciente de lo que realiza y el objetivo final de sus actos.

* **Desigualdad económica:**
*«Es la diferencia que existe en la distribución de bienes, ingresos y rentas dentro de un grupo, sociedad, país o entre países».[@NacionesUnidas]*
Es la circustancia en la que hay presente una diferencia, ya sea vinculada con la renta, el capital o bienestar económico entre los diferentes individuos de población en una concreta zona geográfica.
Esto es debido a que los recursos económicos no se distribuyen de manera equitativa.


# Objetivos
* **Objetivo principal:**
Comparar el nivel de suicidios que hay por cada comunidad autónoma en España según el nivel económico, basándonos en el cociente S80/S20, y según la inaccesibilidad a la atención sanitaria en el ámbito de salud mental.


* **Objetivos secundarios:**
  *
  *
  *





# Materiales y Métodos

Se han obtenido set de datos de la página del INE (Instituto Nacional de Estadística), en el caso de los referentes al índice s80s20 (1)y población por CCAAA (4) y de los datos abiertos ofrecidos por el gobierno de España para obtener los set de datos de suicidios (2) y inaccesibilidad (3).

```{r CargaDatos}
library(readr)
library(tidyverse)

#Desigualdad
desi <- read_delim("INPUT/DATA/desigualdad.csv",
                   delim = ";", escape_double = FALSE, trim_ws = TRUE,
                   col_types = cols(
                     `﻿Territorio`= readr::col_factor(levels = NULL)))

desi<-
  desi %>% 
  mutate(CA = factor(`﻿Territorio`, levels = c("Andalucía", "Aragón", "Asturias", "Baleares, Islas", "Canarias", "Cantabria", "Castilla y León", "Castilla-La Mancha", "Cataluña", "Comunidad Valenciana", "Extremadura", "Galicia", "Madrid, Comunidad de", "Murcia, Región de", "Navarra", "País Vasco", "Rioja, La", "Ceuta", "Melilla", "España")))

desi<-
  desi %>% 
  filter(CA != "España") %>% 
  droplevels()

desi<-
  desi %>% 
  filter(`Año/curso académico` == 2019)

#Inaccesibilidad

ina <- read_delim("INPUT/DATA/inaccesibilidad.csv",
                  delim = ";", escape_double = FALSE, trim_ws = TRUE) 
col_types = cols(
  `Comunidades y Ciudades Autónomas` = readr::col_factor(levels = NULL))

ina<-
  ina %>% 
  mutate(CA = factor(`Comunidades y Ciudades Autónomas`,levels = c("Andalucía", "Aragón", "Asturias (Principado de)", "Balears (Illes)", "Canarias", "Cantabria", "Castilla y León", "Castilla-La Mancha", "Cataluña", "Comunitat Valenciana", "Extremadura", "Galicia", "Madrid (Comunidad de)", "Murcia (Región de)", "Navarra (Comunidad Foral de)", "País Vasco", "Rioja (La)", "Ceuta (Ciudad Autónoma de)", "Melilla (Ciudad Autónoma de)"), labels = c( "Andalucía", "Aragón", "Asturias", "Baleares, Islas", "Canarias", "Cantabria", "Castilla y León", "Castilla-La Mancha", "Cataluña", "Comunidad Valenciana", "Extremadura", "Galicia", "Madrid, Comunidad de", "Murcia, Región de", "Navarra", "País Vasco", "Rioja, La", "Ceuta", "Melilla")))


#Suicidios
sui <- read_delim("INPUT/DATA/suicidios.csv",
                  delim = ";", escape_double = FALSE, trim_ws = TRUE,locale=locale(encoding="latin1"), col_types = cols(
                    `Comunidad y ciudad autónoma de residencia` = readr::col_factor(levels = NULL)))

sui<-
  sui %>% 
  mutate(CA = factor(`Comunidad y ciudad autónoma de residencia`, labels = c( "Total", "Andalucía", "Aragón", "Asturias", "Baleares, Islas", "Canarias", "Cantabria", "Castilla y León", "Castilla-La Mancha", "Cataluña", "Comunidad Valenciana", "Extremadura", "Galicia", "Madrid, Comunidad de", "Murcia, Región de", "Navarra", "País Vasco", "Rioja, La", "Ceuta", "Melilla", "Extranjero")))

sui<-
  sui %>% 
  filter(CA != "Total") %>% 
  filter(CA != "Extranjero") %>% 
  droplevels()

pob <- read_delim("INPUT/DATA/poblacion.csv",
                  delim = ";", escape_double = FALSE, trim_ws = TRUE,locale=locale(encoding="latin1"), col_types = cols(
                    `Comunidades y Ciudades Autónomas` = readr::col_factor(levels = NULL)))
pob<-
  pob %>% 
  mutate(CA = factor(`Comunidades y Ciudades Autónomas`, labels = c("Andalucía", "Aragón", "Asturias", "Baleares, Islas", "Canarias", "Cantabria", "Castilla y León", "Castilla-La Mancha", "Cataluña", "Comunidad Valenciana", "Extremadura", "Galicia", "Madrid, Comunidad de", "Murcia, Región de", "Navarra", "País Vasco", "Rioja, La", "Ceuta", "Melilla")))

```


# Resultados


```{r tablasude}
#Tabla suicidios y desigualdad, población.

sude <- left_join(x = sui, y = desi, by = c("CA"))
sude <- left_join(x = sude, y = pob, by = c("CA"))

sude <- 
  sude %>%
    select(.data = ., Total.x, CA, value, Total.y) %>%
    rename(c(TotalSuicidios = "Total.x")) %>%
    rename(c(TotalPoblacion = "Total.y")) %>%
    rename(c(s80s20= "value")) %>%
    relocate(CA, .before = TotalSuicidios)
#Creo nueva columna
sude$TotalPoblacion <- as.numeric(sude$TotalPoblacion)
sude$porPobSui <- (sude$TotalSuicidios*100) / sude$TotalPoblacion
sude

```


```{r tablasuina}
#Tabla suicidios e innacesibilidad.

suina <- left_join(x = sui, y = ina, by = c("CA"))
suina <- left_join(x = suina, y = pob, by = c("CA"))

suina <- 
  suina %>%
  rename(.data = ., c(TotalSuicidios = "Total.x")) %>%
  rename(c(TipoAtencionSanitaria = "Tipos atención sanitaria")) %>%
  rename(c(AsistenciaSanitaria = "Sí o no")) %>%
  rename(c(TotalInaccesibilidad = "Total.y")) %>%
  rename(c(TotalPoblacion = "Total")) %>%
  select(TotalSuicidios, CA,Sexo.y, TipoAtencionSanitaria, AsistenciaSanitaria, .data = TotalInaccesibilidad, TotalPoblacion) %>%
  relocate(CA, .before = TotalSuicidios)
#Escoge solo "Atención salud mental (psicólogo, psiquiatra...)"
suina <-
  suina %>%
  filter(TipoAtencionSanitaria == "Atención salud mental (psicólogo, psiquiatra...)") %>%
  filter(AsistenciaSanitaria == "Sí") %>%
  filter(Sexo.y == "Ambos sexos") %>%
  select(TotalSuicidios, CA, TotalInaccesibilidad, TotalPoblacion) %>%
  relocate(CA, .before = TotalSuicidios)

#Se pasan los chr a dbl para poder hacer los gráficos
#Se cambia el separador decimal "," por "." para poder hacer el cambio de tipo
suina$TotalInaccesibilidad<-as.numeric(gsub(',', '.',suina$TotalInaccesibilidad))
suina$porPobSui <- (suina$TotalSuicidios*100) / suina$TotalPoblacion
suina$porPobIna <- (suina$TotalInaccesibilidad*100) / suina$TotalPoblacion

suina

```

```{r tablasuina2}
#Tabla suicidios e innacesibilidad por (Atención médica).
suina2<-
  suina%>%
  left_join(x = sui, y = ina, by = c("CA"))%>%
  left_join(x = suina2, y = pob, by = c("CA"))%>%
  rename(.data = suina2, c(TotalSuicidios = "Total.x"))%>%
  rename(.data = suina2, c(TipoAtencionSanitaria = "Tipos atención sanitaria"))%>%
  rename(.data = suina2, c(AsistenciaSanitaria = "Sí o no"))%>%
  rename(.data = suina2, c(TotalInaccesibilidad = "Total.y"))%>%
  rename(.data = suina2, c(TotalPoblacion = "Total"))%>%
  select(.data = suina2, TotalSuicidios, CA,Sexo.y, TipoAtencionSanitaria, AsistenciaSanitaria, TotalInaccesibilidad, TotalPoblacion)%>%
  relocate(.data = suina2, CA, .before = TotalSuicidios)
#Escoge solo "Atención médica"
  
suina2 <-
  suina2 %>%
  filter(suina2, TipoAtencionSanitaria == "Atención médica")%>%
  #Escoge Sí, los que no hay recibido atención médica
  filter(suina2, AsistenciaSanitaria == "Sí")%>%
  #Escoge ambos sexos
  filter(suina2, Sexo.y == "Ambos sexos")%>%
  #Tabla suina2
  select(.data = suina2, TotalSuicidios, CA, TotalInaccesibilidad, TotalPoblacion)%>%
  relocate(.data = suina2, CA, .before = TotalSuicidios)

#Se pasan los chr a dbl para poder hacer los gráficos
#Se cambia el separador decimal "," por "." para poder hacer el cambio de tipo
suina2$TotalInaccesibilidad<-as.numeric(gsub(',', '.',suina2$TotalInaccesibilidad))
suina2$porPobSui <- (suina2$TotalSuicidios*100) / suina2$TotalPoblacion
suina2$porPobIna <- (suina2$TotalInaccesibilidad*100) / suina2$TotalPoblacion

suina2
```

```{r tablasuina3}
#Tabla suicidios e innacesibilidad por (Medicamento recetado).

suina3 <-
  suina %/%
  left_join(x = sui, y = ina, by = c("CA")) %>%
  left_join(x = suina3, y = pob, by = c("CA")) %>%
  rename(.data = suina3, c(TotalSuicidios = "Total.x")) %>%
  rename(.data = suina3, c(TipoAtencionSanitaria = "Tipos atención sanitaria")) %>%
  rename(.data = suina3, c(AsistenciaSanitaria = "Sí o no"))%>%
  rename(.data = suina3, c(TotalInaccesibilidad = "Total.y"))%>%
  rename(.data = suina3, c(TotalPoblacion = "Total"))%>%
  select(.data = suina3, TotalSuicidios, CA,Sexo.y, TipoAtencionSanitaria, AsistenciaSanitaria, TotalInaccesibilidad, TotalPoblacion)%>%
  relocate(.data = suina3, CA, .before = TotalSuicidios)%>%
  #Escoge solo "Atención médica"
  filter(suina3, TipoAtencionSanitaria == "Medicamento recetado")%>%
  #Escoge Sí, los que no hay recibido atención médica
  filter(suina3, AsistenciaSanitaria == "Sí")%>%
  #Escoge ambos sexos
  filter(suina3, Sexo.y == "Ambos sexos")

#Tabla suina3

suina3 <- 
  suina3 %>%
  select(.data = suina3, TotalSuicidios, CA, TotalInaccesibilidad, TotalPoblacion)%>%
  suina3 <- relocate(.data = suina3, CA, .before = TotalSuicidios)

#Se pasan los chr a dbl para poder hacer los gráficos
#Se cambia el separador decimal "," por "." para poder hacer el cambio de tipo
suina3$TotalInaccesibilidad<-as.numeric(gsub(',', '.',suina3$TotalInaccesibilidad))
suina3$porPobSui <- (suina3$TotalSuicidios*100) / suina3$TotalPoblacion
suina3$porPobIna <- (suina3$TotalInaccesibilidad*100) / suina3$TotalPoblacion

suina3
```



```{r tabladesina}

#Tabla desigualdad e inaccesibilidad
desina <- left_join(x = desi, y = ina, by = c("CA"))
desina <- left_join(x = desina, y = pob, by = c("CA"))

desina <- 
  desina %>%
  rename(c(TotalPoblacion = "Total.y")) %>%
  rename(c(TipoAtencionSanitaria = "Tipos atención sanitaria")) %>% 
  #Escoge Sí, los que no hay recibido atención médica
  rename(c(AsistenciaSanitaria = "Sí o no")) %>%
  rename(c(TotalInaccesibilidad = "Total.x")) %>%
  rename(c(s80s20= "value")) %>%
  #Escoge solo "Atención salud mental (psicólogo, psiquiatra...)"
  filter(TipoAtencionSanitaria == "Atención salud mental (psicólogo, psiquiatra...)") %>%
  filter(AsistenciaSanitaria == "Sí") %>%
  #Escoge ambos sexos
  filter(Sexo.x == "Ambos sexos") %>%
  select(s80s20, CA, TotalInaccesibilidad, TotalPoblacion) %>%
  relocate(CA, .before = s80s20)

desina 

#Se pasan los chr a dbl para poder hacer los gráficos
#Se cambia el separador decimal "," por "." para poder hacer el cambio de tipo
desina$TotalInaccesibilidad<-as.numeric(gsub(',', '.',desina$TotalInaccesibilidad))
desina$porPobIna <- (desina$TotalInaccesibilidad*100) / desina$TotalPoblacion
#desina$CA<-sort(desina$CA)

```


# Conclusiones


# Referencias
(1) Desigualdad INE/ https://www.ine.es/jaxi/Tabla.htm?path=/t00/ICV/dim1/l0/&file=11401_2.px&L=0 , Recuperado el 07/11/22.

(2) Inaccesibilidad Gov/ https://datos.gob.es/es/catalogo/ea0010587-inaccesibilidad-a-distintos-tipos-de-atencion-sanitaria-por-motivos-economicos-en-los-ultimos-12-meses-segun-sexo-y-comunidad-autonoma-poblacion-de-15-y-mas-anos-identificador-api-t15-p420-a2019-p02-l0-05016-px , Recuperado el 07/11/22.

(3) Suicidios Gov /https://datos.gob.es/es/catalogo/ea0010587-suicidios-por-comunidades-y-ciudades-autonomas-de-defuncion-sexo-y-medio-empleado-ecm-identificador-api-t15-p417-a2020-l0-06005-px , Recuperado el 07/11/22.

(4) Población INE/ https://www.ine.es/jaxiT3/Tabla.htm?t=2853&L=0 , Recuperado el 07/11/22

* https://www.ine.es/ss/Satellite?L=es_ES&c=INESeccion_C&cid=1259944509412&p=1254735110672&pagename=ProductosYServicios%2FPYSLayout&param1=PYSDetalleFichaIndicador&param3=1259937499084 (introducc segun INe ..)

https://cran.r-project.org/doc/contrib/grafi3.pdf
